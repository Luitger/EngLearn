<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelime √ñƒürenme</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Creepster&family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/material.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: var(--md-background);
            color: var(--md-on-background);
            min-height: 100vh;
            padding: 20px;
        }

        /* Buton fontlarƒ± */
        .md-button, .md-button-outlined, .md-button-secondary, .md-button-accent {
            font-family: 'Fredoka', 'Roboto', sans-serif;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: none;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--md-surface);
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            cursor: pointer;
            box-shadow: var(--md-shadow-3);
            font-size: 24px;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 0;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--md-halloween-orange), var(--md-halloween-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            font-family: 'Creepster', cursive;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            color: var(--md-on-surface);
            opacity: 0.7;
            font-size: 1.1rem;
        }

        .stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
        }

        .stat-card {
            background: var(--md-surface);
            padding: 20px 30px;
            border-radius: 16px;
            box-shadow: var(--md-shadow-2);
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--md-primary);
        }

        .stat-label {
            color: var(--md-on-surface);
            opacity: 0.7;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            max-width: 400px;
            padding: 14px 20px;
            border: 2px solid rgba(0, 0, 0, 0.12);
            border-radius: 25px;
            background: var(--md-surface);
            color: var(--md-on-surface);
            font-size: 1rem;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--md-primary);
        }

        .card-container {
            perspective: 1000px;
            margin: 40px auto;
        }

        .card {
            position: relative;
            width: 100%;
            height: 400px;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: var(--md-shadow-3);
        }

        .card-front {
            background: linear-gradient(135deg, var(--md-primary) 0%, var(--md-primary-variant) 100%);
            color: white;
        }

        .card-back {
            background: var(--md-surface);
            color: var(--md-on-surface);
            transform: rotateY(180deg);
        }

        .word-english {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 20px;
            font-family: 'Fredoka', sans-serif;
            letter-spacing: 1px;
        }

        .word-pronunciation {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 20px;
            font-family: 'Fredoka', sans-serif;
        }

        .word-kiro {
            font-size: 1.5rem;
            color: var(--md-primary);
            font-weight: 600;
            margin-bottom: 15px;
            font-family: 'Fredoka', sans-serif;
        }

        .word-turkish {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 25px;
            font-family: 'Fredoka', sans-serif;
        }

        .word-story {
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: center;
            max-width: 500px;
            font-family: 'Roboto', sans-serif;
        }

        .word-story-tr {
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: center;
            max-width: 500px;
            opacity: 0.7;
            margin-top: 10px;
            font-style: italic;
            display: none;
        }
        
        .word-story-tr.visible {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 0.7; transform: translateY(0); }
        }

        .card-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .flip-hint {
            position: absolute;
            bottom: 20px;
            font-size: 0.9rem;
            opacity: 0.7;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.3; }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--md-surface);
            padding: 40px;
            border-radius: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--md-shadow-5);
        }

        .modal-header {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--md-primary);
        }

        .modal-close {
            float: right;
            font-size: 2rem;
            cursor: pointer;
            color: var(--md-on-surface);
            opacity: 0.7;
        }

        .modal-close:hover {
            opacity: 1;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--md-on-surface);
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(0, 0, 0, 0.12);
            border-radius: 10px;
            background: var(--md-background);
            color: var(--md-on-surface);
            font-size: 1rem;
            font-family: 'Roboto', sans-serif;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: var(--md-primary);
        }

        .story-result {
            background: var(--md-background);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border-left: 4px solid var(--md-primary);
        }

        .test-container {
            display: none;
        }

        .test-container.active {
            display: block;
        }

        .test-question {
            background: var(--md-surface);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: var(--md-shadow-2);
            position: relative;
        }

        .test-question h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--md-primary);
            font-family: 'Fredoka', sans-serif;
            font-weight: 600;
        }
        
        .test-question p {
            font-family: 'Fredoka', sans-serif;
        }

        .test-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(0, 0, 0, 0.1);
            color: var(--md-on-surface);
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 10;
        }

        .test-close-btn:hover {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            transform: rotate(90deg) scale(1.1);
        }

        .test-close-btn:active {
            transform: rotate(90deg) scale(0.95);
        }

        .test-options {
            display: grid;
            gap: 15px;
        }

        .test-option {
            padding: 18px 24px;
            border: 3px solid var(--md-surface);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--md-surface);
            box-shadow: var(--md-shadow-2);
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--md-on-surface);
            position: relative;
            overflow: hidden;
            text-align: center;
            font-family: 'Fredoka', sans-serif;
        }

        .test-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(98, 0, 238, 0.1), transparent);
            transition: left 0.5s;
        }

        .test-option:hover {
            border-color: var(--md-primary);
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--md-shadow-4);
        }

        .test-option:hover::before {
            left: 100%;
        }

        .test-option:active {
            transform: translateY(-1px) scale(0.98);
        }

        .test-option.correct {
            border-color: #48bb78;
            background: linear-gradient(135deg, rgba(72, 187, 120, 0.15), rgba(72, 187, 120, 0.05));
            color: #2f855a;
            font-weight: 600;
            animation: correctPulse 0.5s;
        }

        .test-option.correct::after {
            content: '‚úì';
            position: absolute;
            right: 20px;
            font-size: 1.5rem;
            color: #48bb78;
        }

        .test-option.wrong {
            border-color: #f56565;
            background: linear-gradient(135deg, rgba(245, 101, 101, 0.15), rgba(245, 101, 101, 0.05));
            color: #c53030;
            font-weight: 600;
            animation: wrongShake 0.5s;
        }

        .test-option.wrong::after {
            content: '‚úó';
            position: absolute;
            right: 20px;
            font-size: 1.5rem;
            color: #f56565;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .test-result {
            text-align: center;
            padding: 40px;
        }
        
        .test-result h2 {
            font-family: 'Fredoka', sans-serif;
        }
        
        .test-result p {
            font-family: 'Fredoka', sans-serif;
        }

        .test-score {
            font-size: 4rem;
            font-weight: 700;
            color: var(--md-primary);
            margin: 20px 0;
            font-family: 'Fredoka', sans-serif;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .word-english { font-size: 2.2rem; }
            .card { height: 450px; }
            .controls { flex-direction: column; }
            .search-box { width: 100%; max-width: 100%; }
            .modal-content { padding: 25px; }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">üåô</button>

    <div class="container">
        <header>
            <h1>üï∑Ô∏è Kelime √ñƒürenme</h1>
            <p class="subtitle">Eƒülenceli hikayelerle ƒ∞ngilizce √∂ƒüren!</p>
        </header>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalWords">614</div>
                <div class="stat-label">Toplam Kelime</div>
            </div>
        </div>

        <div class="controls">
            <input type="text" class="search-box" id="searchBox" placeholder="üîç Kelime ara..." />
            <button class="md-button" onclick="loadRandomWord()">üé≤ Yeni Kelime</button>
            <button class="md-button md-button-secondary" onclick="showStoryModal()">‚ú® Hikaye Olu≈ütur</button>
            <button class="md-button md-button-accent" onclick="startTest()">üìù Test √á√∂z</button>
        </div>

        <div class="card-container" id="cardContainer">
            <div class="card" id="flashcard" onclick="flipCard()">
                <div class="card-face card-front">
                    <div class="word-english" id="wordEnglish">Hello</div>
                    <div class="word-pronunciation" id="wordPronunciation">he-lou</div>
                    <button class="md-button" onclick="event.stopPropagation(); speakWord()">üîä Sesli Dinle</button>
                    <div class="flip-hint">üëÜ Kartƒ± √ßevirmek i√ßin tƒ±kla</div>
                </div>
                <div class="card-face card-back">
                    <div class="word-kiro" id="wordKiro">hello (he-lou)</div>
                    <div class="word-turkish" id="wordTurkish">Merhaba</div>
                    <div class="word-story" id="wordStory">Hello! How are you today?</div>
                    <div class="word-story-tr" id="wordStoryTr">Merhaba! Bug√ºn nasƒ±lsƒ±n?</div>
                    <div class="card-actions">
                        <button class="md-button" onclick="event.stopPropagation(); loadRandomWord(); return false;">üé≤ Yeni Kelime</button>
                        <button class="md-button md-button-secondary" id="translateBtn" onclick="event.stopPropagation(); showTranslation(); return false;">üáπüá∑ T√ºrk√ße √áeviri</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Container -->
        <div class="test-container" id="testContainer">
            <div class="test-question" id="testQuestion"></div>
            <div class="test-result" id="testResult" style="display: none;"></div>
        </div>
    </div>

    <!-- Hikaye Olu≈ütur Modal -->
    <div class="modal" id="storyModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeStoryModal()">&times;</span>
            <div class="modal-header">‚ú® Hikaye Olu≈ütur</div>
            <div class="input-group">
                <label>ƒ∞ngilizce Kelime:</label>
                <input type="text" id="customWord" placeholder="√ñrn: beautiful">
            </div>
            <button class="md-button" onclick="generateStory()" style="width: 100%;">Hikaye Olu≈ütur</button>
            <div class="story-result" id="storyResult" style="display: none;">
                <h4 style="margin-bottom: 10px;">üìñ Olu≈üturulan Hikaye:</h4>
                <p id="generatedStory" style="line-height: 1.8;"></p>
                <p id="generatedStoryTr" style="margin-top: 10px; opacity: 0.7; font-style: italic;"></p>
            </div>
        </div>
    </div>

    <script>
        let currentWord = null;
        let allWords = [];

        // Kelimeleri JSON'dan y√ºkle
        async function loadWordsFromFile() {
            console.log('Kelimeler y√ºkleniyor...');
            try {
                const response = await fetch('/static/words.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                allWords = await response.json();
                console.log(`${allWords.length} kelime y√ºklendi!`);
                document.getElementById('totalWords').textContent = allWords.length;
                loadRandomWord();
            } catch (error) {
                console.error('Kelimeler y√ºklenemedi:', error);
                alert('Kelimeler y√ºklenirken hata olu≈ütu! L√ºtfen sayfayƒ± yenileyin.');
                // Yedek kelimeler
                allWords = [
                    {english: "hello", turkish: "merhaba", pronunciation: "he-lou", story: "Hello! How are you today?", story_tr: "Merhaba! Bug√ºn nasƒ±lsƒ±n?"},
                    {english: "world", turkish: "d√ºnya", pronunciation: "w√∂rld", story: "The world is beautiful.", story_tr: "D√ºnya g√ºzeldir."},
                    {english: "love", turkish: "sevgi, a≈ük", pronunciation: "lav", story: "Love makes life beautiful.", story_tr: "Sevgi hayatƒ± g√ºzelle≈ütirir."}
                ];
                document.getElementById('totalWords').textContent = allWords.length;
                loadRandomWord();
            }
        }

        // Tema deƒüi≈ütirme
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.getElementById('themeToggle').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        // Tema y√ºkle
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.getElementById('themeToggle').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';



        function loadRandomWord() {
            if (allWords.length === 0) return;
            
            // Ses √ßalƒ±yorsa durdur
            if (window.speechSynthesis) {
                speechSynthesis.cancel();
            }
            
            currentWord = allWords[Math.floor(Math.random() * allWords.length)];
            displayWord();
            document.getElementById('flashcard').classList.remove('flipped');
        }

        function displayWord() {
            if (!currentWord) return;
            document.getElementById('wordEnglish').textContent = currentWord.english;
            document.getElementById('wordPronunciation').textContent = currentWord.pronunciation;
            document.getElementById('wordKiro').textContent = `${currentWord.english} (${currentWord.pronunciation})`;
            document.getElementById('wordTurkish').textContent = currentWord.turkish;
            document.getElementById('wordStory').textContent = currentWord.story;
            document.getElementById('wordStoryTr').textContent = currentWord.story_tr;
            
            // T√ºrk√ße √ßeviriyi gizle ve butonu sƒ±fƒ±rla
            const storyTr = document.getElementById('wordStoryTr');
            const btn = document.getElementById('translateBtn');
            storyTr.classList.remove('visible');
            if (btn) btn.textContent = 'üáπüá∑ T√ºrk√ße √áeviri';
        }

        function flipCard() {
            document.getElementById('flashcard').classList.toggle('flipped');
        }

        function speakWord() {
            if (!currentWord) return;
            
            // speechSynthesis kontrol√º
            if (!window.speechSynthesis) {
                alert('Tarayƒ±cƒ±nƒ±z ses √∂zelliƒüini desteklemiyor. Chrome veya Firefox kullanmayƒ± deneyin.');
                return;
            }
            
            // Opera GX i√ßin √∂zel d√ºzenleme
            speechSynthesis.cancel();
            
            // Kƒ±sa bekleme (Opera GX i√ßin kritik)
            setTimeout(() => {
                const utterance = new SpeechSynthesisUtterance(currentWord.english);
                utterance.lang = 'en-US';
                utterance.rate = 0.9;
                utterance.pitch = 1.1;
                utterance.volume = 1.0;
                
                // Sesleri al
                const voices = speechSynthesis.getVoices();
                console.log('Mevcut sesler:', voices.length);
                
                if (voices.length > 0) {
                    // ƒ∞ngilizce ses bul
                    const englishVoice = voices.find(v => 
                        v.lang === 'en-US' || 
                        v.lang === 'en-GB' || 
                        v.lang.startsWith('en')
                    );
                    
                    if (englishVoice) {
                        utterance.voice = englishVoice;
                        console.log('Se√ßilen ses:', englishVoice.name);
                    }
                }
                
                utterance.onstart = () => {
                    console.log('‚úì Ses ba≈üladƒ±:', currentWord.english);
                };
                
                utterance.onend = () => {
                    console.log('‚úì Ses bitti');
                };
                
                utterance.onerror = (e) => {
                    console.error('‚úó Ses hatasƒ±:', e.error);
                    alert(`Ses √ßalƒ±namadƒ±: ${e.error}\n\nChrome tarayƒ±cƒ±sƒ±nƒ± deneyin.`);
                };
                
                // Konu≈ü
                try {
                    speechSynthesis.speak(utterance);
                    console.log('speak() √ßaƒürƒ±ldƒ±');
                } catch (err) {
                    console.error('speak() hatasƒ±:', err);
                    alert('Ses sistemi hatasƒ±. L√ºtfen Chrome veya Firefox kullanƒ±n.');
                }
            }, 250);
        }
        
        // Sesleri y√ºkle
        if (window.speechSynthesis) {
            // Sesleri hemen y√ºkle
            let voices = speechSynthesis.getVoices();
            
            // Eƒüer bo≈üsa, deƒüi≈üiklik olduƒüunda y√ºkle
            if (voices.length === 0) {
                speechSynthesis.onvoiceschanged = () => {
                    voices = speechSynthesis.getVoices();
                    console.log(`${voices.length} ses y√ºklendi`);
                };
            }
        }

        // Arama
        document.getElementById('searchBox').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            if (!query) return;
            
            const found = allWords.find(w => 
                w.english.toLowerCase().includes(query) || 
                w.turkish.toLowerCase().includes(query)
            );
            
            if (found) {
                currentWord = found;
                displayWord();
                document.getElementById('flashcard').classList.remove('flipped');
            }
        });

        // T√ºrk√ße √ßeviri g√∂ster
        function showTranslation() {
            const storyTr = document.getElementById('wordStoryTr');
            const btn = document.getElementById('translateBtn');
            
            if (storyTr.classList.contains('visible')) {
                storyTr.classList.remove('visible');
                btn.textContent = 'üáπüá∑ T√ºrk√ße √áeviri';
            } else {
                storyTr.classList.add('visible');
                btn.textContent = '‚ùå √áeviriyi Gizle';
            }
        }

        // Hikaye modal
        function showStoryModal() {
            document.getElementById('storyModal').classList.add('active');
            document.getElementById('storyResult').style.display = 'none';
            document.getElementById('customWord').value = '';
        }

        function closeStoryModal() {
            document.getElementById('storyModal').classList.remove('active');
        }

        function generateStory() {
            const word = document.getElementById('customWord').value.trim().toLowerCase();
            if (!word) {
                alert('L√ºtfen bir kelime girin!');
                return;
            }

            // Kelimeyi bul veya yeni hikaye olu≈ütur
            const foundWord = allWords.find(w => w.english.toLowerCase() === word);
            
            let story, storyTr;
            if (foundWord) {
                // Veritabanƒ±ndaki kelime i√ßin de √ße≈üitli hikayeler
                const tr = foundWord.turkish;
                const templates = [
                    {en: foundWord.story, tr: foundWord.story_tr},
                    {en: `I love ${word}. It makes me happy every day.`, tr: `${tr}'i seviyorum. Her g√ºn beni mutlu ediyor.`},
                    {en: `${word} is amazing! Everyone should know about it.`, tr: `${tr} harika! Herkes bunu bilmeli.`},
                    {en: `Learning about ${word} changed my life.`, tr: `${tr} hakkƒ±nda √∂ƒürenmek hayatƒ±mƒ± deƒüi≈ütirdi.`},
                    {en: `I use ${word} every day in my life.`, tr: `Hayatƒ±mda her g√ºn ${tr} kullanƒ±yorum.`},
                    {en: `${word} is very important in my life.`, tr: `${tr} hayatƒ±mda √ßok √∂nemli.`},
                    {en: `When I think about ${word}, I smile.`, tr: `${tr} d√º≈ü√ºnd√ºƒü√ºmde g√ºl√ºms√ºyorum.`},
                    {en: `${word} reminds me of beautiful memories.`, tr: `${tr} bana g√ºzel anƒ±larƒ± hatƒ±rlatƒ±yor.`},
                    {en: `I want to learn more about ${word}.`, tr: `${tr} hakkƒ±nda daha fazla √∂ƒürenmek istiyorum.`},
                    {en: `${word} is the best thing ever!`, tr: `${tr} ≈üimdiye kadarki en iyi ≈üey!`},
                    {en: `I always think about ${word} before sleeping.`, tr: `Uyumadan √∂nce hep ${tr} d√º≈ü√ºn√ºr√ºm.`},
                    {en: `${word} changed my perspective on life.`, tr: `${tr} hayata bakƒ±≈ü a√ßƒ±mƒ± deƒüi≈ütirdi.`},
                    {en: `People should appreciate ${word} more.`, tr: `ƒ∞nsanlar ${tr}'i daha √ßok takdir etmeli.`},
                    {en: `${word} brings joy to everyone around.`, tr: `${tr} etrafƒ±ndaki herkese ne≈üe getiriyor.`},
                    {en: `${word} is trending on social media now.`, tr: `${tr} ≈üu anda sosyal medyada trend.`},
                    {en: `${word} is more interesting than I thought.`, tr: `${tr} d√º≈ü√ºnd√ºƒü√ºmden daha ilgin√ß.`},
                    {en: `I want to share ${word} with my friends.`, tr: `${tr}'i arkada≈ülarƒ±mla payla≈ümak istiyorum.`},
                    {en: `${word} makes me feel confident and strong.`, tr: `${tr} beni kendimden emin ve g√º√ßl√º hissettiriyor.`},
                    {en: `Every time I see ${word}, I get excited.`, tr: `${tr}'i her g√∂rd√ºƒü√ºmde heyecanlanƒ±yorum.`},
                    {en: `I wish everyone knew about ${word}.`, tr: `Ke≈üke herkes ${tr} hakkƒ±nda bilse.`}
                ];
                const template = templates[Math.floor(Math.random() * templates.length)];
                story = template.en;
                storyTr = template.tr;
            } else {
                // Yeni kelime i√ßin √ße≈üitli ≈üablonlar
                const templates = [
                    {en: `I love ${word}. It makes me happy every day.`, tr: `${word}'i seviyorum. Her g√ºn beni mutlu ediyor.`},
                    {en: `${word} is very important in my life.`, tr: `${word} hayatƒ±mda √ßok √∂nemli.`},
                    {en: `When I think about ${word}, I smile.`, tr: `${word} d√º≈ü√ºnd√ºƒü√ºmde g√ºl√ºms√ºyorum.`},
                    {en: `${word} reminds me of beautiful memories.`, tr: `${word} bana g√ºzel anƒ±larƒ± hatƒ±rlatƒ±yor.`},
                    {en: `I want to learn more about ${word}.`, tr: `${word} hakkƒ±nda daha fazla √∂ƒürenmek istiyorum.`},
                    {en: `${word} is amazing! I can't believe it.`, tr: `${word} harika! ƒ∞nanamƒ±yorum.`},
                    {en: `Everyone talks about ${word} these days.`, tr: `Bug√ºnlerde herkes ${word} hakkƒ±nda konu≈üuyor.`},
                    {en: `I discovered ${word} recently and I love it!`, tr: `${word}'i yakƒ±n zamanda ke≈üfettim ve bayƒ±ldƒ±m!`},
                    {en: `${word} makes everything better.`, tr: `${word} her ≈üeyi daha iyi yapƒ±yor.`},
                    {en: `I can't imagine my life without ${word}.`, tr: `${word} olmadan hayatƒ±mƒ± hayal edemiyorum.`},
                    {en: `My friend told me about ${word} yesterday.`, tr: `Arkada≈üƒ±m d√ºn bana ${word} hakkƒ±nda anlattƒ±.`},
                    {en: `${word} is the best thing ever!`, tr: `${word} ≈üimdiye kadarki en iyi ≈üey!`},
                    {en: `I always think about ${word} before sleeping.`, tr: `Uyumadan √∂nce hep ${word} d√º≈ü√ºn√ºr√ºm.`},
                    {en: `${word} changed my perspective on life.`, tr: `${word} hayata bakƒ±≈ü a√ßƒ±mƒ± deƒüi≈ütirdi.`},
                    {en: `People should appreciate ${word} more.`, tr: `ƒ∞nsanlar ${word}'i daha √ßok takdir etmeli.`},
                    {en: `${word} brings joy to everyone around.`, tr: `${word} etrafƒ±ndaki herkese ne≈üe getiriyor.`},
                    {en: `I learned about ${word} in school today.`, tr: `Bug√ºn okulda ${word} hakkƒ±nda √∂ƒürendim.`},
                    {en: `${word} is trending on social media now.`, tr: `${word} ≈üu anda sosyal medyada trend.`},
                    {en: `My teacher explained ${word} very well.`, tr: `√ñƒüretmenim ${word}'i √ßok iyi a√ßƒ±kladƒ±.`},
                    {en: `${word} is more interesting than I thought.`, tr: `${word} d√º≈ü√ºnd√ºƒü√ºmden daha ilgin√ß.`},
                    {en: `I want to share ${word} with my friends.`, tr: `${word}'i arkada≈ülarƒ±mla payla≈ümak istiyorum.`},
                    {en: `${word} makes me feel confident and strong.`, tr: `${word} beni kendimden emin ve g√º√ßl√º hissettiriyor.`},
                    {en: `Every time I see ${word}, I get excited.`, tr: `${word}'i her g√∂rd√ºƒü√ºmde heyecanlanƒ±yorum.`},
                    {en: `${word} is something I truly appreciate.`, tr: `${word} ger√ßekten takdir ettiƒüim bir ≈üey.`},
                    {en: `I wish everyone knew about ${word}.`, tr: `Ke≈üke herkes ${word} hakkƒ±nda bilse.`}
                ];
                const template = templates[Math.floor(Math.random() * templates.length)];
                story = template.en;
                storyTr = template.tr;
            }

            document.getElementById('generatedStory').textContent = story;
            document.getElementById('generatedStoryTr').textContent = storyTr;
            document.getElementById('storyResult').style.display = 'block';
        }

        // Test sistemi
        let testQuestions = [];
        let currentQuestion = 0;
        let correctAnswers = 0;

        function startTest() {
            console.log('Test ba≈ülatƒ±lƒ±yor, kelime sayƒ±sƒ±:', allWords.length);
            
            if (allWords.length === 0) {
                alert('Kelimeler hen√ºz y√ºklenmedi! L√ºtfen bekleyin...');
                return;
            }
            
            if (allWords.length < 4) {
                alert('Test i√ßin en az 4 kelime gerekli!');
                return;
            }

            // Test sorularƒ±nƒ± hazƒ±rla
            testQuestions = [];
            const shuffled = [...allWords].sort(() => Math.random() - 0.5);
            const testWords = shuffled.slice(0, Math.min(10, allWords.length));

            testWords.forEach(word => {
                // Yanlƒ±≈ü cevaplar i√ßin diƒüer kelimeleri al
                const wrongAnswers = allWords
                    .filter(w => w.english !== word.english)
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 3)
                    .map(w => w.turkish);

                const options = [word.turkish, ...wrongAnswers].sort(() => Math.random() - 0.5);

                testQuestions.push({
                    word: word.english,
                    correct: word.turkish,
                    options: options
                });
            });

            currentQuestion = 0;
            correctAnswers = 0;

            // Test ekranƒ±nƒ± g√∂ster
            console.log('Test ekranƒ± g√∂steriliyor...');
            document.getElementById('cardContainer').style.display = 'none';
            document.querySelector('.controls').style.display = 'none';
            const testContainer = document.getElementById('testContainer');
            const testQuestion = document.getElementById('testQuestion');
            const testResult = document.getElementById('testResult');
            
            testContainer.classList.add('active');
            testContainer.style.display = 'block';
            testQuestion.style.display = 'block';
            testResult.style.display = 'none';
            
            console.log('Test container g√∂r√ºn√ºr:', testContainer.style.display);

            showQuestion();
        }

        function showQuestion() {
            console.log('showQuestion √ßaƒürƒ±ldƒ±, soru:', currentQuestion);
            
            if (currentQuestion >= testQuestions.length) {
                showTestResult();
                return;
            }

            const q = testQuestions[currentQuestion];
            const questionDiv = document.getElementById('testQuestion');
            
            console.log('Soru g√∂steriliyor:', q);

            questionDiv.innerHTML = `
                <button class="test-close-btn" onclick="exitTest()" title="Testi Kapat">‚úï</button>
                <h3>Soru ${currentQuestion + 1}/${testQuestions.length}</h3>
                <p style="font-size: 2rem; font-weight: 700; margin: 20px 0; color: var(--md-primary);">${q.word}</p>
                <p style="margin-bottom: 20px; opacity: 0.7;">Bu kelimenin T√ºrk√ße kar≈üƒ±lƒ±ƒüƒ± nedir?</p>
                <div class="test-options">
                    ${q.options.map((opt, i) => `
                        <div class="test-option" onclick="checkAnswer('${opt.replace(/'/g, "\\'")}', '${q.correct.replace(/'/g, "\\'")}', this)">
                            ${opt}
                        </div>
                    `).join('')}
                </div>
            `;
            
            questionDiv.style.display = 'block';
        }

        function checkAnswer(selected, correct, element) {
            const options = document.querySelectorAll('.test-option');
            options.forEach(opt => opt.style.pointerEvents = 'none');

            if (selected === correct) {
                element.classList.add('correct');
                correctAnswers++;
            } else {
                element.classList.add('wrong');
                // Doƒüru cevabƒ± g√∂ster
                options.forEach(opt => {
                    if (opt.textContent.trim() === correct) {
                        opt.classList.add('correct');
                    }
                });
            }

            setTimeout(() => {
                currentQuestion++;
                showQuestion();
            }, 1500);
        }

        function showTestResult() {
            const percentage = Math.round((correctAnswers / testQuestions.length) * 100);
            const resultDiv = document.getElementById('testResult');

            let emoji = 'üéâ';
            let message = 'Harika!';
            if (percentage < 50) {
                emoji = 'üí™';
                message = 'Daha fazla √ßalƒ±≈ümalƒ±sƒ±n!';
            } else if (percentage < 80) {
                emoji = 'üëç';
                message = 'ƒ∞yi i≈ü √ßƒ±kardƒ±n!';
            }

            resultDiv.innerHTML = `
                <div style="font-size: 5rem;">${emoji}</div>
                <h2 style="margin: 20px 0; color: var(--md-primary);">${message}</h2>
                <div class="test-score">%${percentage}</div>
                <p style="font-size: 1.2rem; margin-bottom: 30px;">
                    ${correctAnswers} / ${testQuestions.length} doƒüru cevap
                </p>
                <button class="md-button" onclick="exitTest()">Ana Sayfaya D√∂n</button>
                <button class="md-button md-button-accent" onclick="startTest()" style="margin-left: 10px;">üîÑ Yeni Test</button>
            `;

            document.getElementById('testQuestion').style.display = 'none';
            resultDiv.style.display = 'block';
        }

        function exitTest() {
            const testContainer = document.getElementById('testContainer');
            testContainer.classList.remove('active');
            testContainer.style.display = 'none';
            document.getElementById('cardContainer').style.display = 'block';
            document.querySelector('.controls').style.display = 'flex';
            document.getElementById('testQuestion').style.display = 'block';
        }

        // Ba≈ülat
        loadWordsFromFile();
    </script>
</body>
</html>
